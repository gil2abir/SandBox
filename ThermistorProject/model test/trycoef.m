clear all;


tau=12;
dc=8.5e-3;
syms r1 r2 c1 c2;

res=solve( r1+r2==62.5,...
           1/c1+1/c2==1/tau*dc,...  
      1/0.13==-0.5*((-(r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))-((((r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))^2-4/(r1*r2*c1*c2))^(1/2))),...
       1/3==-0.5*((-(r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))+((((r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))^2-4/(r1*r2*c1*c2))^(1/2))),...   
           'PrincipalValue',true);

       
           
R1=(double(res.r1));
R2=(double(res.r2));
C1=(double(res.c1));
C2=(double(res.c2));

       
tf=27.8;
 ti=21.9;       %R2*C2+R1*C1+C1*R2       R1*R2*C1*C2
Tstep=tf-ti;
a=(-2*Tstep)/((((R2*C2+R1*C1+C1*R2)/(R1*R2*C1*C2))^2-4/(R1*R2*C1*C2))^(0.5)*(R2*C2+R1*C1+C1*R2-((R2*C2+R1*C1+C1*R2)^2-4*R1*R2*C1*C2)^(0.5)));
b=-0.5*((-(R2*C2+R1*C1+C1*R2)/(R1*R2*C1*C2))-((((R2*C2+R1*C1+C1*R2)/(R1*R2*C1*C2))^2-4/(R1*R2*C1*C2))^(1/2)));
c=(2*Tstep)/((((R2*C2+R1*C1+C1*R2)/(R1*R2*C1*C2))^2-4/(R1*R2*C1*C2))^(0.5)*(R2*C2+R1*C1+C1*R2+((R2*C2+R1*C1+C1*R2)^2-4*R1*R2*C1*C2)^(0.5)));
d=-0.5*((-(R2*C2+R1*C1+C1*R2)/(R1*R2*C1*C2))+((((R2*C2+R1*C1+C1*R2)/(R1*R2*C1*C2))^2-4/(R1*R2*C1*C2))^(1/2)));


dt=0.008; % time step , sec
t=0:dt:60;
T_NoCon=a.*(1-exp(-b*t))+c.*(1-exp(-d*t))+21.9;
Treg=1.65.*(1-exp(-0.13*t))+4.25.*(1-exp(-3.03*t))+21.9;
figure
plot(t,T_NoCon);
hold on 
plot(t,Treg);
legend ('assumed', 'real');


% a=(-2*Tstep)/(((r2*c2+r1*c1+c1*r2)^2-4*r1*r2*c1*c2)^(1/2))*((-(r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))+(((r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))^2-4/(r1*r2*c1*c2))^(1/2));
% b=-0.5*((-(r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))+((((r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))^2-4/(r1*r2*c1*c2))^(1/2)));
% c=-(2*Tstep)/((((r2*c2+r1*c1+c1*r2)^2+4*r1*r2*c1*c2)^(1/2))*((-(r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))-(((r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))^2-4/(r1*r2*c1*c2))^(1/2)));
% d=-0.5*((-(r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))-((((r2*c2+r1*c1+c1*r2)/(r1*r2*c1*c2))^2-4/(r1*r2*c1*c2))^(1/2)));
